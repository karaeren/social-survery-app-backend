import{s as P,r as h,O as W,v as Y,x as f,I as Z,J as H,S as X,T as ee,L as te,K as oe,G as ne,Y as se,Z as ae,l as le,o as d,c as w,e as o,w as s,u as r,V as k,W as b,i as y,j as v,A as x,_ as re,$ as ie,a0 as ue,a1 as ce,a2 as de}from"./vendor.0d9fb7aa.js";/* empty css                *//* empty css                     *//* empty css               *//* empty css                  */import{u as me}from"./index.a0b1e89c.js";import{u as _e}from"./survey.d476d253.js";const pe={class:"main centered-main"},fe={class:"question-box-no",style:{"margin-bottom":"16px"}},we=y("h3",{style:{"margin-right":"12px"}},"Questions",-1),ye=v("Add Question"),ve={class:"question-box-no"},ge={style:{margin:"0 12px"}},he=v(" Delete "),ke=v(" Add Answer "),be=v(" Create Survey "),Qe={setup(xe){const p=me(),{getSurveys:Q,createSurvey:q,getCategories:I}=_e(),U=P(),g=h([]),C=h([]),V=h([]),m={lastId:3,1:3,2:3},n=W({name:"",description:"",categoryId:"",questions:[{question_id:1,question_text:"Question 1",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]},{question_id:2,question_text:"Question 2",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]}]}),A=(e,t,l)=>{const i=e[t];e[t]=e[l],e[l]=i},D=e=>{n.questions.splice(e,1)},O=()=>{const e=m.lastId;m[e]=3,m.lastId++,n.questions.push({question_id:e,question_text:"Question "+e,answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]})};Y(async()=>{if(!!p.access.token){try{g.value=await I(p.access.token)}catch(e){return console.error(e),f.alert("An unknown error happened while trying to retrieve categories...","Error",{confirmButtonText:"OK"})}for await(const e of g.value)C.value.push({id:e.id,text:e.name,value:e.name});await $()}});async function $(){V.value=[];let e;try{e=await Q(p.access.token)}catch(t){return console.error(t),f.alert("An unknown error happened while trying to retrieve list of surveys...","Error",{confirmButtonText:"OK"})}await K(e)}async function K(e){for await(const t of e.results){const l=g.value.filter(i=>i.id===t.categoryId);V.value.push({id:t.id,name:t.name,description:t.description,categoryId:t.categoryId,category:l.length?l[0].name:"Unknown Category",submissionCount:t.submissionCount})}}function E(e,t){t==="up"&&e===0||t==="down"&&e===n.questions.length-1||(t==="up"?A(n.questions,e,e-1):t==="down"&&A(n.questions,e,e+1))}function F(e,t){n.questions[e].answers.splice(t,1)}function L(e){const t=m[n.questions[e].question_id];m[n.questions[e].question_id]++,n.questions[e].answers.push({answer_id:t,answer_text:"Answer "+t})}async function N(){let e;try{e=await q(p.access.token,n)}catch(t){console.error(t);let l="An unknown error happened while trying to create the survey...";return t.response&&t.response.data.message&&(l=t.response.data.message),f.alert(l,"Error",{confirmButtonText:"OK"})}console.log(e),f.alert("Survey created successfully.","Success!",{confirmButtonText:"OK",callback:()=>{U.push("list-surveys")}})}return(e,t)=>{const l=Z,i=H,z=X,M=ee,S=te,c=oe,R=ne,j=se,G=ae,J=le;return d(),w("div",pe,[o(J,{class:"scrollbar-box"},{default:s(()=>[o(S,{model:r(n),"label-position":"left"},{default:s(()=>[o(i,{label:"Name","label-width":"140px"},{default:s(()=>[o(l,{modelValue:r(n).name,"onUpdate:modelValue":t[0]||(t[0]=a=>r(n).name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Description","label-width":"140px"},{default:s(()=>[o(l,{modelValue:r(n).description,"onUpdate:modelValue":t[1]||(t[1]=a=>r(n).description=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Category","label-width":"140px"},{default:s(()=>[o(M,{modelValue:r(n).categoryId,"onUpdate:modelValue":t[2]||(t[2]=a=>r(n).categoryId=a),placeholder:"Please select a category"},{default:s(()=>[(d(!0),w(k,null,b(C.value,a=>(d(),x(z,{key:a.id,label:a.value,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),y("div",fe,[we,o(c,{onClick:O},{default:s(()=>[ye]),_:1})]),o(G,{style:{"padding-left":"0"}},{default:s(()=>[(d(!0),w(k,null,b(r(n).questions,(a,_)=>(d(),x(j,{key:a.question_id,center:""},{default:s(()=>[o(R,null,{default:s(()=>[y("div",ve,[o(c,{type:"primary",icon:r(re),size:"small",circle:"",onClick:u=>E(_,"up")},null,8,["icon","onClick"]),o(c,{type:"primary",icon:r(ie),size:"small",circle:"",onClick:u=>E(_,"down")},null,8,["icon","onClick"]),y("h4",ge," Question #"+ue(a.question_id),1),o(c,{type:"danger",icon:r(ce),size:"small",circle:"",onClick:u=>D(_)},null,8,["icon","onClick"])]),o(S,{ref_for:!0,ref:"formRef",model:a,"label-width":"120px","label-position":"left",style:{"margin-top":"1rem"}},{default:s(()=>[o(i,{prop:"name",label:"Question"},{default:s(()=>[o(l,{modelValue:a.question_text,"onUpdate:modelValue":u=>a.question_text=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(d(!0),w(k,null,b(a.answers,(u,B)=>(d(),x(i,{key:u.key,label:"Answer",prop:"answers."+B+".value"},{default:s(()=>[o(l,{modelValue:u.answer_text,"onUpdate:modelValue":T=>u.answer_text=T},null,8,["modelValue","onUpdate:modelValue"]),o(c,{style:{"margin-top":"0.5rem"},onClick:de(T=>F(_,B),["prevent"])},{default:s(()=>[he]),_:2},1032,["onClick"])]),_:2},1032,["prop"]))),128)),o(i,null,{default:s(()=>[o(c,{onClick:u=>L(_)},{default:s(()=>[ke]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(c,{type:"primary",onClick:N},{default:s(()=>[be]),_:1})]),_:1})])}}};export{Qe as default};

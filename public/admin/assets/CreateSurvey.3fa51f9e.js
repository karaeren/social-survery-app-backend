import{s as W,r as h,O as Y,v as Z,x as f,I as G,J as H,S as X,T as ee,L as te,K as oe,B as ne,Y as se,Z as ae,l as le,o as d,c as w,e as o,w as s,u as l,V as k,W as b,i as y,j as v,A as x,_ as re,$ as ie,a0 as ue,a1 as ce,a2 as de}from"./vendor.2f5e2848.js";/* empty css                     */import{u as _e}from"./survey.9daf437d.js";import{u as me}from"./index.abe41e06.js";const pe={class:"main centered-main"},fe={class:"question-box-no",style:{"margin-bottom":"16px"}},we=y("h3",{style:{"margin-right":"12px"}},"Questions",-1),ye=v("Add Question"),ve={class:"question-box-no"},ge={style:{margin:"0 12px"}},he=v(" Delete "),ke=v(" Add Answer "),be=v(" Create Survey "),Se={setup(xe){const p=me(),{getSurveys:Q,createSurvey:q,getCategories:I}=_e(),U=W(),g=h([]),C=h([]),V=h([]),_={lastId:3,1:3,2:3},n=Y({name:"",description:"",categoryId:"",questions:[{question_id:1,question_text:"Question 1",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]},{question_id:2,question_text:"Question 2",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]}]}),A=(e,t,r)=>{const i=e[t];e[t]=e[r],e[r]=i},D=e=>{n.questions.splice(e,1)},O=()=>{const e=_.lastId;_[e]=3,_.lastId++,n.questions.push({question_id:e,question_text:"Question "+e,answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]})};Z(async()=>{if(!!p.access.token){try{g.value=await I(p.access.token)}catch(e){return console.error(e),f.alert("An unknown error happened while trying to retrieve categories...","Error",{confirmButtonText:"OK"})}for await(const e of g.value)C.value.push({id:e.id,text:e.name,value:e.name});await $()}});async function $(){V.value=[];let e;try{e=await Q(p.access.token)}catch(t){return console.error(t),f.alert("An unknown error happened while trying to retrieve list of surveys...","Error",{confirmButtonText:"OK"})}await K(e)}async function K(e){for await(const t of e.results){const r=g.value.filter(i=>i.id===t.categoryId);V.value.push({id:t.id,name:t.name,description:t.description,categoryId:t.categoryId,category:r.length?r[0].name:"Unknown Category",submissionCount:t.submissionCount})}}function E(e,t){t==="up"&&e===0||t==="down"&&e===n.questions.length-1||(t==="up"?A(n.questions,e,e-1):t==="down"&&A(n.questions,e,e+1))}function F(e,t){n.questions[e].answers.splice(t,1)}function L(e){const t=_[n.questions[e].question_id];_[n.questions[e].question_id]++,n.questions[e].answers.push({answer_id:t,answer_text:"Answer "+t})}async function N(){let e;try{e=await q(p.access.token,n)}catch(t){return console.error(t),f.alert("An unknown error happened while trying to create the survey...","Error",{confirmButtonText:"OK"})}console.log(e),f.alert("Survey created successfully.","Success!",{confirmButtonText:"OK",callback:()=>{U.push("list-surveys")}})}return(e,t)=>{const r=G,i=H,z=X,M=ee,S=te,c=oe,R=ne,j=se,J=ae,P=le;return d(),w("div",pe,[o(P,{class:"scrollbar-box"},{default:s(()=>[o(S,{model:l(n),"label-position":"left"},{default:s(()=>[o(i,{label:"Name","label-width":"140px"},{default:s(()=>[o(r,{modelValue:l(n).name,"onUpdate:modelValue":t[0]||(t[0]=a=>l(n).name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Description","label-width":"140px"},{default:s(()=>[o(r,{modelValue:l(n).description,"onUpdate:modelValue":t[1]||(t[1]=a=>l(n).description=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Category","label-width":"140px"},{default:s(()=>[o(M,{modelValue:l(n).categoryId,"onUpdate:modelValue":t[2]||(t[2]=a=>l(n).categoryId=a),placeholder:"Please select a category"},{default:s(()=>[(d(!0),w(k,null,b(C.value,a=>(d(),x(z,{key:a.id,label:a.value,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),y("div",fe,[we,o(c,{onClick:O},{default:s(()=>[ye]),_:1})]),o(J,{style:{"padding-left":"0"}},{default:s(()=>[(d(!0),w(k,null,b(l(n).questions,(a,m)=>(d(),x(j,{key:a.question_id,center:""},{default:s(()=>[o(R,null,{default:s(()=>[y("div",ve,[o(c,{type:"primary",icon:l(re),size:"small",circle:"",onClick:u=>E(m,"up")},null,8,["icon","onClick"]),o(c,{type:"primary",icon:l(ie),size:"small",circle:"",onClick:u=>E(m,"down")},null,8,["icon","onClick"]),y("h4",ge," Question #"+ue(a.question_id),1),o(c,{type:"danger",icon:l(ce),size:"small",circle:"",onClick:u=>D(m)},null,8,["icon","onClick"])]),o(S,{ref_for:!0,ref:"formRef",model:a,"label-width":"120px","label-position":"left",style:{"margin-top":"1rem"}},{default:s(()=>[o(i,{prop:"name",label:"Question"},{default:s(()=>[o(r,{modelValue:a.question_text,"onUpdate:modelValue":u=>a.question_text=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(d(!0),w(k,null,b(a.answers,(u,B)=>(d(),x(i,{key:u.key,label:"Answer",prop:"answers."+B+".value"},{default:s(()=>[o(r,{modelValue:u.answer_text,"onUpdate:modelValue":T=>u.answer_text=T},null,8,["modelValue","onUpdate:modelValue"]),o(c,{style:{"margin-top":"0.5rem"},onClick:de(T=>F(m,B),["prevent"])},{default:s(()=>[he]),_:2},1032,["onClick"])]),_:2},1032,["prop"]))),128)),o(i,null,{default:s(()=>[o(c,{onClick:u=>L(m)},{default:s(()=>[ke]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(c,{type:"primary",onClick:N},{default:s(()=>[be]),_:1})]),_:1})])}}};export{Se as default};

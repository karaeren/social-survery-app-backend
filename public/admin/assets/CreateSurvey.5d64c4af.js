import{s as J,r as k,O as W,v as X,x as w,I as Z,J as H,S as ee,T as te,U as oe,K as ne,L as ae,G as le,Z as se,_ as re,l as ie,o as d,c as y,e as o,w as l,u as s,W as h,X as x,i as v,j as _,A as b,$ as ue,a0 as ce,a1 as de,a2 as me,a3 as pe}from"./vendor.9334939d.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css               */import{u as _e}from"./index.7c68fd32.js";import{u as fe}from"./survey.b7f4628a.js";const we={class:"main centered-main"},ye=_(" Remove Expiration "),ve={class:"question-box-no",style:{"margin-bottom":"16px"}},ge=v("h3",{style:{"margin-right":"12px"}},"Questions",-1),ke=_("Add Question"),he={class:"question-box-no"},xe={style:{margin:"0 12px"}},be=_(" Delete "),Ve=_(" Add Answer "),Ce=_(" Create Survey "),qe={setup(Ae){const f=_e(),{getSurveys:T,createSurvey:U,getCategories:Q}=fe(),q=J(),g=k([]),V=k([]),C=k([]),m={lastId:3,1:3,2:3},n=W({name:"",description:"",categoryId:"",expireDate:null,questions:[{question_id:1,question_text:"Question 1",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]},{question_id:2,question_text:"Question 2",answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]}]}),A=(e,t,r)=>{const i=e[t];e[t]=e[r],e[r]=i},I=e=>{n.questions.splice(e,1)},Y=()=>{const e=m.lastId;m[e]=3,m.lastId++,n.questions.push({question_id:e,question_text:"Question "+e,answers:[{answer_id:1,answer_text:"Answer 1"},{answer_id:2,answer_text:"Answer 2"}]})};X(async()=>{if(!!f.access.token){try{g.value=await Q(f.access.token)}catch(e){return console.error(e),w.alert("An unknown error happened while trying to retrieve categories...","Error",{confirmButtonText:"OK"})}for await(const e of g.value)V.value.push({id:e.id,text:e.name,value:e.name});await M()}});async function M(){C.value=[];let e;try{e=await T(f.access.token)}catch(t){return console.error(t),w.alert("An unknown error happened while trying to retrieve list of surveys...","Error",{confirmButtonText:"OK"})}await $(e)}async function $(e){for await(const t of e.results){const r=g.value.filter(i=>i.id===t.categoryId);C.value.push({id:t.id,name:t.name,description:t.description,categoryId:t.categoryId,category:r.length?r[0].name:"Unknown Category",submissionCount:t.submissionCount})}}function E(e,t){t==="up"&&e===0||t==="down"&&e===n.questions.length-1||(t==="up"?A(n.questions,e,e-1):t==="down"&&A(n.questions,e,e+1))}function O(e,t){n.questions[e].answers.splice(t,1)}function K(e){const t=m[n.questions[e].question_id];m[n.questions[e].question_id]++,n.questions[e].answers.push({answer_id:t,answer_text:"Answer "+t})}async function F(){let e;try{e=await U(f.access.token,n)}catch(t){console.error(t);let r="An unknown error happened while trying to create the survey...";return t.response&&t.response.data.message&&(r=t.response.data.message),w.alert(r,"Error",{confirmButtonText:"OK"})}console.log(e),w.alert("Survey created successfully.","Success!",{confirmButtonText:"OK",callback:()=>{q.push("list-surveys")}})}return(e,t)=>{const r=Z,i=H,L=ee,N=te,z=oe,c=ne,D=ae,P=le,R=se,j=re,G=ie;return d(),y("div",we,[o(G,{class:"scrollbar-box"},{default:l(()=>[o(D,{model:s(n),"label-position":"left"},{default:l(()=>[o(i,{label:"Name","label-width":"140px"},{default:l(()=>[o(r,{modelValue:s(n).name,"onUpdate:modelValue":t[0]||(t[0]=a=>s(n).name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Description","label-width":"140px"},{default:l(()=>[o(r,{modelValue:s(n).description,"onUpdate:modelValue":t[1]||(t[1]=a=>s(n).description=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(i,{label:"Category","label-width":"140px"},{default:l(()=>[o(N,{modelValue:s(n).categoryId,"onUpdate:modelValue":t[2]||(t[2]=a=>s(n).categoryId=a),placeholder:"Please select a category"},{default:l(()=>[(d(!0),y(h,null,x(V.value,a=>(d(),b(L,{key:a.id,label:a.value,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"Expiration Date","label-width":"140px"},{default:l(()=>[o(z,{modelValue:s(n).expireDate,"onUpdate:modelValue":t[3]||(t[3]=a=>s(n).expireDate=a),type:"date",placeholder:"Pick a day",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"]),o(c,{style:{"margin-left":"1em"},onClick:t[4]||(t[4]=a=>s(n).expireDate=null)},{default:l(()=>[ye]),_:1})]),_:1})]),_:1},8,["model"]),v("div",ve,[ge,o(c,{onClick:Y},{default:l(()=>[ke]),_:1})]),o(j,{style:{"padding-left":"0"}},{default:l(()=>[(d(!0),y(h,null,x(s(n).questions,(a,p)=>(d(),b(R,{key:a.question_id,center:""},{default:l(()=>[o(P,null,{default:l(()=>[v("div",he,[o(c,{type:"primary",icon:s(ue),size:"small",circle:"",onClick:u=>E(p,"up")},null,8,["icon","onClick"]),o(c,{type:"primary",icon:s(ce),size:"small",circle:"",onClick:u=>E(p,"down")},null,8,["icon","onClick"]),v("h4",xe," Question #"+de(a.question_id),1),o(c,{type:"danger",icon:s(me),size:"small",circle:"",onClick:u=>I(p)},null,8,["icon","onClick"])]),o(D,{ref_for:!0,ref:"formRef",model:a,"label-width":"120px","label-position":"left",style:{"margin-top":"1rem"}},{default:l(()=>[o(i,{prop:"name",label:"Question"},{default:l(()=>[o(r,{modelValue:a.question_text,"onUpdate:modelValue":u=>a.question_text=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(d(!0),y(h,null,x(a.answers,(u,S)=>(d(),b(i,{key:u.key,label:"Answer",prop:"answers."+S+".value"},{default:l(()=>[o(r,{modelValue:u.answer_text,"onUpdate:modelValue":B=>u.answer_text=B},null,8,["modelValue","onUpdate:modelValue"]),o(c,{style:{"margin-top":"0.5rem"},onClick:pe(B=>O(p,S),["prevent"])},{default:l(()=>[be]),_:2},1032,["onClick"])]),_:2},1032,["prop"]))),128)),o(i,null,{default:l(()=>[o(c,{onClick:u=>K(p)},{default:l(()=>[Ve]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(c,{type:"primary",onClick:F},{default:l(()=>[Ce]),_:1})]),_:1})])}}};export{qe as default};

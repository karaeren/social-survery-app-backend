import{r as d,N as v,v as g,x as c,P as C,I as E,K as k,Q as B,o as T,c as x,e,u as D,w as s,j as S,X as p}from"./vendor.0d9fb7aa.js";/* empty css                        *//* empty css               */import{u as U,b as A}from"./index.a0b1e89c.js";const I={class:"main centered-main"},L=S(" Delete "),j={setup(V){const n=U(),{getAllUsers:m,deleteUser:h}=A(),l=d([]),w=v(()=>l.value.filter(t=>!r.value||t.name.toLowerCase().includes(r.value.toLowerCase())||t.email.toLowerCase().includes(r.value.toLowerCase()))),r=d("");g(async()=>{!n.access.token||(await u(),console.log(l.value))});async function u(){try{const t=await m(n.access.token);t.results.forEach(a=>{a.birthdate&&(a.birthdate=new Date(a.birthdate).toISOString().split("T")[0]),a.surveyCount=a.submittedSurveys.length}),l.value=t.results}catch(t){return console.error(t),c.alert("An unknown error happened while trying to retrieve users...","Error",{confirmButtonText:"OK"})}}function b(t){c.confirm("Are you sure you want to delete this user? This is irreversible!","Warning",{confirmButtonText:"Yes",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{try{await h(n.access.token,t),p({type:"success",message:"Delete completed"}),await u()}catch(a){return console.error(a),c.alert("Couldn't delete user, an unknown error happened...","Error",{confirmButtonText:"OK"})}}).catch(()=>{p({type:"info",message:"Delete canceled"})})}return(t,a)=>{const o=C,f=E,_=k,y=B;return T(),x("div",I,[e(y,{data:D(w),"default-sort":{prop:"rank"},height:"100vh",style:{width:"100%"}},{default:s(()=>[e(o,{fixed:"",prop:"role",label:"Role",sortable:"",width:"90"}),e(o,{prop:"id",label:"ID",sortable:"",width:"240"}),e(o,{prop:"name",label:"name",sortable:"",width:"240"}),e(o,{prop:"email",label:"Email",sortable:"",width:"240"}),e(o,{prop:"gender",label:"Gender",width:"120"}),e(o,{prop:"birthdate",label:"Birthdate",width:"180"}),e(o,{prop:"surveyCount",label:"# of Submitted Surveys",sortable:"",width:"130"}),e(o,{fixed:"right",align:"right","min-width":"240"},{header:s(()=>[e(f,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=i=>r.value=i),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),default:s(i=>[e(_,{type:"danger",size:"small",onClick:K=>b(i.row.id)},{default:s(()=>[L]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}};export{j as default};
